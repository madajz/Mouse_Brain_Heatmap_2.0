# Mouse_Brain_Heatmap
rmd with the framework to create Mouse brain heatmaps.

This code was written to use the SVG originally downloaded from this source http://api.brain-map.org/api/v2/svg_download/100883867?groups=28. Please see the their terms of service https://alleninstitute.org/legal/terms-use/ to ensure your use of this code fits both the GNU general pubic license 3 and the Allen Insitutes terms of service.  In very brief and overly simplified terms, if this code is used purely for academic purposes, it may be used freely so long as both the image source and this code are properly cited. 

The figure this code generates corresponds to the cross-section found here http://atlas.brain-map.org/atlas?atlas=2#atlas=2&structure=771&resolution=16.75&x=7754.41796875&y=3899.83447265625&zoom=-3&plate=100883867&z=6.  To use a different cross-section or image, you merely need to replace 100883867 in the svg_download link above with the new ID/plate number. Caution: a recent download of this cross-section may have different layer numbers than what is hard-coded in this .rmd file.

Once downloaded this SVG was converted to a postscript file (PS) via Inkscape (see 100883867.ps cor the converted file). The code in R then converts the PS file to an RGML (an R XML file). The XML file is what we then used to manually map each of the displayed brain structures to the corresponding name in the data (eg. AON corresponded to region/layer 83 in the xml conversion and AOB was layers 79 and 81) (see the code comments for more details).  This code also has an option to interpolate the unscored regions based on spatial coordinates and scores of the scored regions (e.g. via AKIMA); other options are to default these regions to the lowest score (0), or grey out these brain regions. 
